# Data Warehouse Analyst

## Общая информация
Аналитика показателей продаж OZON на базе современного стека инструментов - airbyte, postgres, dagster, dbt, superset.

## Цели
1. Декларативный подход к организации обработки данных
2. Орекстрация данных ELT через одно «окно».
3. Визализация и аналитика показателей в Apache Superset.

## Планы
1. Развернуть сервисы в YC
2. Настроить коннекторы для выгрузки и загрузки данных.
3. Провести трансформацию данных для BI
4. «Уложить» все в оркестратор
5. Визуализировать в BI

## Используемые технологии
* Airbyte - сервис для выгрузки и загрузки сырых данных.
* PostgreSQL – хранилище данных (DWH).
* Dagster – оркестратор.
* DBT - трансформация данных.
* Superset - визуацлизация данных.

## Что получилось

1. Исходный набор данных “Продажи OZON 2020” размещен на гугл диске. 
https://drive.google.com/drive/folders/1VJrJ2PKcXxKt-k4zoJfO5_qFrkNWDM0y?ths=true

![image]()

2. Архитектура проекта
   
![image](https://github.com/petryak-off/otus_dz/blob/main/стек.jpg)

3. Развертыывание инфраструктуры

* Развертывание БД Postgres через маркетплейс Yandex Cloud
* Создание ВМ для airbyte, dagster, dbt. Где airbyte, dagster были развернуты при помощи докера, dbt развернут локально в корень папки дагстера для удосбтва подклюяения моделей к оркестратору. 
* Отдельная ВМ для BI Superset на базе докера.

7. Код дага трансформации в ODS и DDS загруженных данных из STG, а также структура соответствующего проекта dbt при использовании Cosmos для связки с Airflow

![image](https://github.com/savadevel/OpenDataByModernStack/assets/69199994/dc644e75-022d-4609-8842-17ec9dfa5239)

8. Даги пайплана загрузки открытых данных правительства Москвы

![image](https://github.com/savadevel/OpenDataByModernStack/assets/69199994/b3862521-7422-404c-b227-49e8c2e0eabc)

9. Граф дага трансформации загруженных данных в STG

![image](https://github.com/savadevel/OpenDataByModernStack/assets/69199994/e1ea5dc7-5850-4c74-a88d-245f495c0523)

10. Анализ зависимостей в BI

![image](https://github.com/savadevel/OpenDataByModernStack/assets/69199994/0dd5d432-be95-4229-9281-3acba3865cd9)

# Схема потоков данных
![image](https://github.com/savadevel/OpenDataByModernStack/assets/69199994/e0fc8ae7-aac6-4934-bcfc-e96fd1f5c40e)

# Выводы и планы по развитию
1. Выбранный стек позволят построить пайплайн загрузки данных
2. Cosmos позволяет связать AirFlow c dbt, а это дает сделать оркестрация функционала dbt из "коробки", как, например, создание моделей данных, тестирование и инкрементальную загрузку протестированных данных 
3. Дальнейшие планы по развитию:
* вынести в настройку задание наборов загружаемых открытых данных 
* минимизировать количество операций по настройки созданных контейнеров (запустил "docker compose up" и перешел к анализу данных в Superset) 
* создание инфраструктуры сделать через Terraform 
* использовать облачные ресурсы
* выстроить зависимость дагов загрузки данных
* документирование проекта 
